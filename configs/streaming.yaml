profiles:
  # Shared defaults (may be overridden per profile).
  base:
    streaming:
      codec: h264
      bitrate: 6M
      fps: 60
      gop: 60
      max_clients: 3
      nvenc_max_sessions: 0
      pipewire_fastpath: true
      gst_use_cuda_upload: false
    fifo:
      enabled: false
      container: mpegts
      dir: temp/streams
    go2rtc:
      enabled: false
      url: http://127.0.0.1:1984
      mode: fifo

  # Developer-friendly defaults:
  # - allow auto backend selection
  # - keep /stream.mp4 usable for the Vite dashboard (MSE)
  dev:
    streaming:
      backend: auto
      container: mp4
      allow_gst_mp4: false
      require_zero_copy: false

  # Local app defaults (Tauri / Vite spectator):
  # - MP4/MSE friendly output
  # - no go2rtc dependency
  # - allow pixel_obs fallback for fully headless stacks
  # - reduce FPS to keep 1080p stable across multiple featured tiles
  local:
    streaming:
      backend: auto
      container: mp4
      bitrate: 10M
      fps: 30
      gop: 15
      allow_gst_mp4: false
      require_zero_copy: false
      max_clients: 3
      nvenc_max_sessions: 0
    fifo:
      enabled: false
    go2rtc:
      enabled: false

  # Production/training defaults:
  # - deterministic backend (GStreamer)
  # - enforce GPU-only streaming (no CPU raw-frame fallback)
  # - prefer go2rtc + FIFO distribution for viewers
  prod:
    streaming:
      backend: gst
      container: mpegts
      allow_gst_mp4: true
      require_zero_copy: true
      pipewire_fastpath: true
      gst_use_cuda_upload: true
      max_clients: 2
      nvenc_max_sessions: 2
      gop: 60
    fifo:
      enabled: true
      container: mpegts
      dir: temp/streams
    go2rtc:
      enabled: true
      url: http://127.0.0.1:1984
      mode: fifo
